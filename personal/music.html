<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Music | Ben Boyette</title>
  <meta name="description" content="Personal music collection and private listening sessions." />
  <meta name="theme-color" content="#2563eb" />
  <meta property="og:title" content="Music | Ben Boyette" />
  <meta property="og:description" content="Personal music collection and listening sessions." />
  <meta property="og:type" content="website" />
  <link rel="manifest" href="/manifest.json" />
  <link rel="stylesheet" href="../assets/css/styles.css" />
  <script src="../assets/js/main.js" defer></script>
  <script>if ('serviceWorker' in navigator) navigator.serviceWorker.register('/sw.js');</script>
</head>

<body>
  <div id="protected-content" style="display:none;">
    <div id="navbar"></div>

    <main class="container">
      <section class="intro">
        <h1>Music</h1>
        <p>A private collection of tracks and sessions.</p>
      </section>

      <section class="section">
        <h2>Sessions</h2>
        <div class="track-list" style="display: grid; gap: 1rem;">
          <button class="track-btn" onclick="loadTrack(0)">Diamond (Cinematic)</button>
          <button class="track-btn" onclick="loadTrack(1)">Nature Ambience (32 min)</button>
          <button class="track-btn" onclick="loadTrack(2)">Bronx Zoo Freestyle</button>
          <button class="track-btn" onclick="loadTrack(3)">Golden Goose Freestyle</button>
          <button class="track-btn" onclick="loadTrack(4)">Winter Storm Freestyle</button>
          <button class="track-btn" onclick="loadTrack(5)">99 Build Freestyle</button>
        </div>
      </section>
    </main>
  </div>

  <div id="music-player">
    <img id="album-art" src="" alt="Album Art">
    <div class="player-header">Now Playing</div>
    <div id="track-title" style="font-weight: 600; margin-bottom: 0.5rem;">Nothing Playing</div>

    <div class="time-row"
      style="display: flex; justify-content: space-between; font-size: 0.75rem; opacity: 0.7; margin-bottom: 0.25rem;">
      <span id="current-time">0:00</span>
      <span id="duration">0:00</span>
    </div>

    <input type="range" id="progress" value="0" min="0" max="100"
      style="width: 100%; margin-bottom: 1rem; accent-color: var(--accent);">

    <div class="controls" style="display: flex; justify-content: center; gap: 1.5rem;">
      <button onclick="prevTrack()"
        style="background: none; border: none; font-size: 1.5rem; color: white; cursor: pointer;">⏮</button>
      <button onclick="togglePlay()" id="play-btn"
        style="background: white; border: none; width: 44px; height: 44px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 1.25rem; color: black; cursor: pointer;">▶</button>
      <button onclick="nextTrack()"
        style="background: none; border: none; font-size: 1.5rem; color: white; cursor: pointer;">⏭</button>
    </div>
    <audio id="audio"></audio>
  </div>

  <style>
    .track-btn {
      background: var(--card-bg);
      border: 1px solid var(--card-border);
      padding: 1rem 1.5rem;
      border-radius: 12px;
      text-align: left;
      font-size: 1rem;
      font-weight: 500;
      color: var(--text-main);
      cursor: pointer;
      transition: all 0.2s ease;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .track-btn:hover {
      background: var(--accent-soft);
      border-color: var(--accent);
      transform: translateX(4px);
    }

    .track-btn::after {
      content: '▶';
      font-size: 0.8rem;
      opacity: 0.5;
    }

    #album-art:not([src]) {
      display: none;
    }
  </style>

  <script>
    // Password Protection
    document.addEventListener("DOMContentLoaded", () => {
      const PASSWORD = "benbpassword";
      const input = prompt("Enter password:");
      if (input !== PASSWORD) {
        document.body.innerHTML = "<div style='display:grid; place-items:center; height: 100vh;'><div class='section'><h2>Access Denied</h2><p>Please contact the site owner for access.</p></div></div>";
      } else {
        document.getElementById("protected-content").style.display = "block";
      }
    });

    // Player Data
    const tracks = [
      { title: "Diamond (Cinematic)", src: "../assets/music/diamond-cinematic.mp3" },
      { title: "Nature Ambience (32 min)", src: "../assets/music/nature-thirty-min.mp3" },
      { title: "Bronx Zoo Freestyle", src: "../assets/music/Birthday Blizzard 26/01-Bronx-Zoo-Freestyle.mp3", art: "../assets/images/birthday-blizzard_music.jpg" },
      { title: "Golden Goose Freestyle", src: "../assets/music/Birthday Blizzard 26/02-Golden-Goose-Freestyle.mp3", art: "../assets/images/birthday-blizzard_music.jpg" },
      { title: "Winter Storm Freestyle", src: "../assets/music/Birthday Blizzard 26/03-Winter-Storm-Freestyle.mp3", art: "../assets/images/birthday-blizzard_music.jpg" },
      { title: "99 Build Freestyle", src: "../assets/music/Birthday Blizzard 26/04-99-Build-Freestyle.mp3", art: "../assets/images/birthday-blizzard_music.jpg" }
    ];

    let currentTrack = 0;
    const audio = document.getElementById("audio");
    const trackTitle = document.getElementById("track-title");
    const progress = document.getElementById("progress");
    const currentTimeEl = document.getElementById("current-time");
    const durationEl = document.getElementById("duration");
    const playBtn = document.getElementById("play-btn");
    const albumArt = document.getElementById("album-art");
    const player = document.getElementById("music-player");

    function loadTrack(index) {
      currentTrack = index;
      audio.src = tracks[index].src;
      trackTitle.textContent = tracks[index].title;
      if (tracks[index].art) {
        albumArt.src = tracks[index].art;
        albumArt.style.display = "block";
      } else {
        albumArt.style.display = "none";
      }
      audio.play();
      playBtn.textContent = "⏸";
      trackPlay(tracks[index].title);
    }

    function togglePlay() {
      if (!audio.src) return;
      if (audio.paused) {
        audio.play();
        playBtn.textContent = "⏸";
      } else {
        audio.pause();
        playBtn.textContent = "▶";
      }
    }

    function prevTrack() {
      currentTrack = (currentTrack - 1 + tracks.length) % tracks.length;
      loadTrack(currentTrack);
    }

    function nextTrack() {
      currentTrack = (currentTrack + 1) % tracks.length;
      loadTrack(currentTrack);
    }

    audio.addEventListener("timeupdate", () => {
      const percent = (audio.currentTime / audio.duration) * 100;
      progress.value = percent || 0;
      currentTimeEl.textContent = formatTime(audio.currentTime);
      durationEl.textContent = formatTime(audio.duration);
    });

    progress.addEventListener("input", () => {
      audio.currentTime = (progress.value / 100) * audio.duration;
    });

    audio.addEventListener("ended", () => nextTrack());

    function formatTime(time) {
      if (!time) return "0:00";
      const minutes = Math.floor(time / 60);
      const seconds = Math.floor(time % 60).toString().padStart(2, "0");
      return `${minutes}:${seconds}`;
    }

    function trackPlay(track) {
      const plays = JSON.parse(localStorage.getItem("plays") || "{}");
      plays[track] = (plays[track] || 0) + 1;
      localStorage.setItem("plays", JSON.stringify(plays));
    }
  </script>
</body>

</html>